<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Attack Tree Assistant</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Load JointJS CSS FIRST so our stylesheet can override it -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.7/joint.css" />
  <!-- Our overrides (e.g., hiding link tools, cursor styles, etc.) -->
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="app">

    <div id="toolbar">
      <button id="btn-new">New root</button>
      <button id="btn-add">Add node</button>
      <button id="btn-and">AND</button>
      <button id="btn-or">OR</button>
      <button id="btn-rename">Rename</button>
      <button id="btn-delete">Delete</button>
      <button id="btn-clear">Clear</button>

      <button id="btn-save" style="margin-left:auto;">Save</button>
      <button id="btn-load">Load</button>
      <span id="sel-label">No selection</span>
    </div>

    <!-- Study chip -->
    <div id="study-toolbar" class="chip hidden">
      <span id="study-mode">mode: ?</span> Â·
      <span id="study-scenario">scenario: ?</span>
      <button id="btn-download-log">Download log</button>
    </div>

    <div id="paper-container"></div>

    <!-- Assistant panel -->
    <div id="kb-panel">
      <div class="tabs">
        <button data-tab="suggest" class="active">Suggest</button>
        <button data-tab="review">Review</button>
        <button data-tab="explain">Explain</button>
      </div>
      <div class="tab-body" id="tab-suggest"></div>
      <div class="tab-body hidden" id="tab-review"></div>
      <div class="tab-body hidden" id="tab-explain"></div>
    </div>

    <!-- Session modal -->
<div id="session-modal" class="modal hidden">
  <div class="modal-card">
    <h3>Start Session</h3>
    <label>Participant ID
      <input id="part-id" placeholder="P01" />
    </label>
    <label>Session ID
      <input id="sess-id" placeholder="2025-08-25T12-00" />
    </label>
    <div class="row">
      <button id="btn-start-session">Start</button>
    </div>
  </div>
</div>

<!-- Add an End button next to Download log -->
<script>
  // add an End Session button beside Download log after DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    const chip = document.getElementById('study-toolbar');
    if (!chip) return;
    const endBtn = document.createElement('button');
    endBtn.id = 'btn-end-session';
    endBtn.textContent = 'End session';
    chip.insertBefore(endBtn, document.getElementById('btn-download-log'));
  });
</script>


  </div>

  <!-- Vendor scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.5.0/backbone-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.7/joint.min.js"></script>

  <!-- App scripts -->
  <script src="js/utils.js"></script>
  <script src="js/kb-core.js"></script>
  <script src="js/kb-woz.js"></script>
  <script src="js/kb-ui.js"></script>
  <script src="js/study.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
